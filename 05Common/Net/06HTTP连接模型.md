# HTTP 连接模型

连接管理是一个 HTTP 的关键话题，打开和保持连接很大程度上影响着网络和web应用程序的性能。在 HTTP/1.x 中有三种模型：短连接、长连接、HTTP 流水线

HTTP 传输协议主要依赖于 TCP 来提供从客户端到服务端之间的连接，在早期，HTTP 使用一个简单模型来处理这样的连接，这些连接的声明周期是短暂的，每发起一个请求时都会创建一个新的连接，并在收到应答时关闭。

这个简单模型对性能有先天的限制，打开一个 TCP 连接都是相当耗费资源的操作。客户端和服务端之间往往要交换好多个消息，当请求发起时，网络延迟和带宽都会对性能造成影响。现代浏览器往往要发起很多次请求才能拿到所需要的完整信息。证明了这个效率的底下。

有两个新的模型诞生，首先是长连接模型，它会保持连接去完成多次连续的请求，减少了不断重新打开连接的时间，然后是 HTTP 流水线模型，他还要先进一些，多个连续的请求甚至都不用等待立即返回就可以被发送。这样就减少了耗费在网络上的延迟时间。

HTTP/2 新增了其他连接模型。

要注意的一个重点是 HTTP 的连接管理适用于两个连续节点之间的连接。如`hop-by-hop`，而不是`end-to-end`。当模型从一个客户端到第一个代理服务器的连接和从代理服务器到目标服务器之间的连接效果可能是不一样的。HTTP 协议受不同连接模型的影响，比如`Connection`和`Keep-Alive`，就是`hop-to-hop`协议头，它们的值是可以被中间节点更改的。

