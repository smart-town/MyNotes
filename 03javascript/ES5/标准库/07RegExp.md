# RegExp

## 概述

Regular Expression 是一种表达文本模式的方法。

新建正则表达式：字面量`/xyz/`或`new RegExp('xyz')`

两种写法是等价的，都新建了一个`xyz`的正则表达式对象。主要区别在于第一种方法在引擎编译代码时，就会新建正则表达式，第二种方法在运行时新建正则表达式，所以前者效率较高，且比较便利和直观。

## 实例属性

和修饰符有关的属性：`RegExp.prototype.ignoreCase`、`global`、`multiine`、`flags`

与修饰符无关`lastIndex`返回一个整数，表示下次搜索开始的位置。`source`返回正则表达式的字符串形式。

## 实例方法

### RegExp.prototype.test()

正则实例对象的`test`方法返回一个布尔值，表示当前模式是否能够匹配参数字符串。`/cat/.test('cats and dogs')//true`

### RegExp.prototype.exec()

正则实例对象的`exec`方法，用来返回匹配结果。如果发现匹配，就返回一个数组，成员是匹配成功的子字符串。否则返回`null`

如果正则表达式包含圆括号，即“组匹配”，则返回的数组包括多个成员，第一个成员是匹配成功的结果，后面的成员是圆括号对应的匹配成功的组。也就是说，第二个成员对应第一个圆括号。第三个成员对应第二个圆括号。

`exec`返回的数组还包括`index`和`input`属性，分别表示模式匹配成功开始的位置，以及原始字符串。

### 字符串实例方法

`match()`、`search()`、`replace()`、`split()`

## 匹配规则

### 字面量和元字符

大部分字符在正则表达式中就是字面的含义，如`/a/`匹配`a`。这种叫做“字面量字符”。除此之外还有一部分字符含有特殊含义，不代表字面的意思，叫做“元字符”：
- `.`: 匹配除了回车、换行、行分隔符、段分隔符之外的所有字符。注意对于码点大于`0XFFFF`字符，点字符不能正确匹配。
- 位置字符：`^`表示字符串开始位置，`$`表示字符串结束位置。
- 选择字符：`|`表示或关系。如`cat|dog`表示匹配`cat`或`dog`，`/11|22/.test('911')`。多个选择字符可以联合使用，选择符会包含前后多个字符，如果要修改这个行为可以使用圆括号：`/a( |\t)b/.test('a\tb')`，a和b之间有一个空格或
- 其他元字符包含：`\`、`\*`、`+`、`?`、`()`、`[]`、`{}`等

### 转义字符

正则表达式中含有特殊含义的元字符，如果要匹配它们自身，就需要在它们前面加上反斜杠。如要匹配`+`就要写成`\+`，**需要特别注意的是**，如果使用`RegExp`方法生成正则对象，转移需要使用两个斜杠，因为字符串内部会先转义一次。即：`new RegExp("1\\+")`

### 字符类

字符类表示有一系列字符可供选择，只要匹配其中一个就可以了，所有可供选择的字符都放在方括号中。如`[xyz]`表示`x`、`y`、`z`中任意一个。

#### 跳脱符`^`

如果方括号内第一个字符为`^`则表示除了字符类中的字符，其他字符都可以匹配。如`[^]`表示匹配一切字符

注意跳脱符只有在字符类的第一个位置才有意义，否则就是字面意义。

#### 连字符`-`

某些情况下，对于连续序列的字符，`-`可以提供简写形式，如`[abc]`可以写为`[a-c]`

### 预定义模式

预定义模式指的是某些常见模式的简写方式

- `\d`表示匹配0-9
- `\D`表示匹配0-9以外的字符
- `\w`匹配任意的字母、数字、下划线。即`[A-Za-z0-9_]`
- `\W`除所有字母、数字、下划线的字符
- `\s`匹配空格，包括换行符、制表符、空格符
- `\S`
- `\b`匹配单词的边界`/\bworld/.test('hello world')//true`
- `\B`匹配非词边界`/\Bworld/.test('hello-world')//false`

**通常**，正则表达式遇到换行符`\n`就会停止匹配。

### 重复类

模式的精确匹配次数，`{}`表示。`{n}`表示恰好重复`n`次。`{n,}`表示至少`n`次。`{n,m}`

### 量词符

- `?`匹配 0 次或 1 次。
- `*`表示匹配 0 次或多次
- `+`表示匹配 1 次或多次

### 贪婪模式

以上的三个量词符，默认情况下都是最大可能匹配，即匹配到下一个字符不能满足匹配规则为止。这称为**贪婪模式**。`/a+/`表示匹配 1 个或多个 `a`。那么到底会匹配多少个`a`呢，因为默认是贪婪模式，会一直匹配到字符`a`不出现为止。

如果要将贪婪模式改为非贪婪模式，可以在量词后加一个问号。如`"aaa".match(/a+?/)//["a"]`

### 修饰符

修饰符表示模式附加的规则，放在正则模式的最尾部。可以单个使用也可以一起使用`/test/ig`

#### g

默认第一次匹配成功后，正则对象就停止向下匹配了。`g`表示全局匹配，加上它之后，正则对象将匹配所有符合条件的结果。主要用于搜索和替换。

#### i

不区分大小写。

#### m

表示多行模式`multiline`，会修改`^`和`$`的行为。默认情况下，`^`和`$`匹配字符串的开始处和结尾处。加上`m`后，还会匹配行首和行尾。即会识别换行符。

## 组匹配

正则表达式的括号表示分组匹配，括号中的模式可以用来匹配分组的内容。






