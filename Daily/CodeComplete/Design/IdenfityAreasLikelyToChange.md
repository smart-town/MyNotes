# Identify Areas Likely to Change

找出容易改变的区域。

1. 找出看起来容易变化的项目
2. 将容易变化的项目分离出来
3. 将看起来容易变化的项目隔离开来

## 1、常见的容易发生变化的区域

### 业务规则

业务规则很容易称为软件频繁变化的根源，国会改变了税率结构，工会重新谈判合同的内容，保险公司改变了它的税率表……如果你遵循信息隐藏的原则，那么基于这些业务规则的逻辑就不应该遍布于整个程序，而是仅仅隐藏于系统的某个角落，直到需要对它进行改动，才将它拎出来。

### 对硬件的依赖性

与屏幕、打印机、键盘、鼠标、硬盘、声音设施以及通信设计等之间的接口都是硬件依赖的例子。请将对于硬件的依赖隔离到它们自身的子系统或者类中。这种隔离会非常有利于你将程序移植到新的硬件环境下。另外，当你为可能变化的硬件开发程序时，这样做也会有很大的帮助。你可以写软件来模拟与特定硬件的交互，在硬件尚不稳定或者不可用的时候，让硬件接口子系统使用该模拟器，当硬件可用的时候再将硬件接口子系统和模拟器切断，最终连接到真正的硬件设备上。

### 输入和输出

在做比纯硬件接口层稍高一些层面上的设计时，输入输出也是一个容易变化的区域。如果你的程序创建了自己的数据文件，那么改文件格式可能会随着软件开发的不断深化而变化。用户层的输入和输出格式也会改变——输出页面上字段的位置、数量和排列顺序等都可能发生改变。因此检查所有的外部接口，看看有哪些可能的变化通常是一个不错的主意。

### 非标准的语言特性

大多数编程语言的实现中都包含了一些便利的、非标准的扩展，对于这些扩展的使用就像双刃剑一样，因为它们可能在其他的环境中不可用，不论该环境是一套不同的硬件、不同发行商所发行的语言版本，还是同一发行商发行的同一语言的新版本。

如果你使用了编程语言的非标准扩展，请把这样的扩展单独隐藏在某个类中。以便当你转移到新环境时可以用自己写的代码去取代它。与此类似，如果你使用了并非在所有环境中都可用的子程序库，请将这些子程序库隐藏在一个接口的后面，为新环境做好准备。

### 困难的设计区域和构建区域

将困难的设计区域和构建区域隐藏起来也是很好的想法，因为这些代码可能因为设计得很差而需要重做。请将它们隔离出来，将拙劣的设计和“构建”对系统其余部分的可能影响降至最低。

### 状态变量

状态变量用于表示程序的状态，与大多数其他的数据相比，这种东西更容易改变。在一个典型的应用场景中你可能一开始使用布尔变量来定义出错状态，然后又发现用具有`ErrorType_None`、`ErrorType_Warning`、`ErrorType_Fata1`等值的枚举类型来表示该状态更好。

你可以**在使用状态变量时增加至少两层的灵活性和可读性**：
- 不要使用布尔变量作为状态变量，请换用枚举类型，给状态变量增加一个新的状态是很常见的，给枚举类型增加一个新的状态只需要重新编译一次，而无需对每行检查该状态变量的代码都做一次全面修订
- 使用访问器子程序(access routine)取代对状态变量的直接检查。通过检查访问器子程序而不是检查状态变量，使得程序能够去测试更复杂的状态情况。例如，如果你想要联合检查某一错误状态变量和当前功能状态变量，那么如果该条测试语句隐藏在一段子程序中，这就很容易做到；而如果将该测试语句硬件码到程序各处，则会困难重重

### 数据量的限制

当你定义了一个具有 100 个元素的数组时，你实际上是向外界透露一些他们并不需要知道的信息。保护好你的隐私！信息隐藏并不总是像创建新类一样复杂，有时候它就像使用具名常量`MAX_EMPLOYEES`来隐藏 100 一样简单。

## 2、Anticipating Different Degrees of Change 预料不同程度的变化

当你在考虑系统中潜在的变化时，应该设法设计好你的系统，让这些变化的影响或范围与发生该变化的可能性成反比。如果一种变化很可能发生，那么要确保系统能够很容易地对它作出响应。只有那些极不可能发生的变化才能导致系统中多于一个类发生明显的变化。优秀的设计者还能够很好地预料应对变化所需成本。相比，如果某个变化特别容易发生又容易作出计划，你就应该在如何对付它上多下些功夫，不要将精力过多浪费在那些不太可能发生而又很难做出计划的变化上。

找出容易发生变化的区域的一个好方法是：首先找出程序中可能对用户有用的最小子集，这一子集构成了系统的核心，不容易发生改变。接下来，用微小的步伐扩充这个系统。这里的增量可以非常微小，小到看似微不足道。当你考虑功能上的改变时，同时也要考虑质的变化：比如说让程序变成线程安全的，使程序能够本地化等。这些潜在的改进区域就构成了系统中的潜在变化。请按照信息隐藏的原则来设计这些区域，**通过首先定义清楚核心，你可以认清有哪些组件属于附加功能，这时候就可以将它们提取出来，并将它们的可能改进隐藏起来**
