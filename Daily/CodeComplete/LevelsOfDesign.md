# 设计的层次

需要在一个软件系统的若干不同细节层次上进行设计。有些设计技术适用于所有的层次，有些只适用于某些层次上。

**一个程序中的设计层次，系统首先被组织为子系统，子系统进一步分解为类，然后类又被分解为子程序和数据。每个子程序的内部也需要进行设计**

## Level1: Software System

第一个层次就是整个系统，有的程序员直接从系统层次就开始设计类，但是往往先从子系统或者包这些类的更高组织层次来思考会更有益处。

## Level2: Division into Subsystems or Packages

在这一层次上设计的主要成果是识别出所有的主要子系统。这些子系统可能会很大，比如说数据库、用户界面、业务规则、命令解释器、报表引擎等等。这一层的主要设计活动就是确定如何将程序分解为主要的子系统，并定义清楚允许各个子系统如何使用其他子系统。对于任何至少需要几周时间才能完成的项目，在这一层次上进行划分通常都是必需的，在每个子系统的的内部可能要用到不同的设计方法——请对系统中的每一部分选用最恰当的方法。

在这一层次中，有一点特别重要，即不同子系统之间的相互通信的规则。如果所有子系统都能同其他子系统通信，那么你就完全失去了将它们分开带来的好处。应该通过限制子系统之间的通信来让每个子系统更有存在意义。

只有当“确需了解”——最好还有合理的理由时，才允许子系统之间的通信。如果你还拿不准该如何设计的话，那么就应该先对子系统之间的通信加以限制，等以后需要时再放松，这比先不限制，等子系统之间已经有了上百个调用时再加以限制要容易许多。

### 常用的子系统

有些种类的子系统会在不同的系统中反复出现，以下几种就比较常见：

- **业务规则**
- **用户界面**
- **数据库访问**
- **对系统的依赖性**

## Level3: Division into Classes

在这一层次上的设计包括识别出系统中所有的类。例如，数据库接口子系统可能会别进一步划分成数据访问类、持久化框架类以及数据库元数据。

当定义子系统中的类的时候，也就同时定义了这些类与系统的其余部分大交道的细节。尤其是要确定好类的接口。总的来说，这一层的主要设计任务是将所有的子系统进行适当的分解。并确保出分解出的细节都恰到好处，能够用单个类实现。

## Level4: Division into Routines

分解成子程序

这一层的设计包括将每个类细分为子程序。第三层中定义出的类接口已经定义了其中一些子程序。而第四层设计将细化出类的私用子程序。当你查看类中子程序的细节时，会发现很多子程序都很简单，但是也有些子程序是由更多层次化组织的子程序所组成的，这就需要更多的设计工作了。

完整地定义出类内部的子程序，常常会有助于更好地理解类的接口。反过来又有助于对类的接口进行进一步修改。

这一层次的分解和设计通常是由程序员个人来完成的，他对于用时超过几个小时的项目而言就是必须要做的了，虽然不用非常正式地完成这一步骤，但是至少也要在脑海中完成。

## Level5: Internal Routine Design

子程序内部的设计

在子程序层次上进行设计就是为每个子程序布置详细的功能，子程序内部的设计工作通常是由负责该子程序的开发人员来完成的。这里的设计工作包括编写伪代码、选择算法、组织子程序内部的代码块，以及用编程语言编写代码。这一层的设计工作总是需要做的，尽管有的时候很不在意或者很差劲，有时候是经过深思熟虑而出色完成的。