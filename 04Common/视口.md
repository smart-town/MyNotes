# 视口

[MDN](https://developer.mozilla.org/zh-CN/docs/Web/CSS/Viewport_concepts)  
[blog1](https://www.cnblogs.com/xiaohuochai/p/5496995.html)

## 1. 概念

视口`viewport`代表当前可见的计算机图形区域，在 web 浏览器术语中，通常与浏览器窗口相同。但不包括浏览器的 UI，菜单栏等——即指你正在浏览的文档的那一部分。

文档比如一个 html 网页，可能非常长，**你的 viewport 就是你现在所能见到的所有事物**，需要注意的是“什么是视口区域”这个问题，页面中的一些导航菜单也包括在其中。Viewport 的大小取决于屏幕的大小，无论浏览器是否处于全屏模式，是否被用户缩放了。viewport 外的区域，如某个网页的底部部分，可能需要滚动到其所在的区域才会出现在屏幕上。

- 在尺寸较大的设备中，在这些设备上，应用显示区域不一定是全屏的，viewport 是浏览器窗口的大小。
- 在大多数移动端设备下，浏览器是全屏的，viewport 是整个屏幕的大小
- 在全屏模式下，viewport 是设备屏幕的范围，窗口是浏览器窗口，浏览器窗口大小小于或等于视口的大小，并且文档是这个网站，文档的大小可比 viewport 长或宽。

### ViewPort 大小可变

Viewport 的宽度并不总是窗口的宽度，如果你测试 Chrome 或 Firefox 中的 window 和 document 的宽和高，可能会得到不同的结果。以下是一些帮助你查看 viewport 大小和其他类似长度属性的 DOM 属性：
- 文档的 `Element.clientWidth` 是指一个文档使用`css pixels`单位表示的内部宽度，包括其 padding。**这就是 viewport 的宽度**
- `Window.innerWidth` 是用 css pixels 单位表示的浏览器窗口 viewport 宽度，包括垂直滚动条，如果渲染了的话。
- `Window.outerWidth` 包括了浏览器外边框的窗口宽度。

在实际测试中，`innerWidth`和`outerWidth`是相同的，但是`outerHeight`比`innerHeight`高 100px，这是因为`outerHeight`的测量包括浏览器框架在内，包括了地址栏和书签栏总共 100px 的高度，而浏览器没有左右边框

`innerHeight`和`innerWidth`通常被认为**布局视口**。

当缩放时，Firefox 和 Chrome 对 `innerWidth`和`clientWidth`给出了新的 css 像素大小，浏览器对`outerWidth`和`outerHeight`的返回值有差异。Firefox 返回了缩放后的 css 像素值，Chrome 返回了默认的像素值。【测试后发现好像都返回的是缩放后的像素值】

web 浏览器包含两个 viewport，**布局视口**和**视觉视口**，visual viewport 指的是当前浏览器中可见的部分，并且可以变化，当使用触屏缩放时，当动态键盘在手机上弹出的时候，或者之前隐藏的地址栏变得可见的时候，visual viewport 缩小了，但是 layout viewport 却保持不变。

对于`fix`布局固定到头部或者尾部，其是固定在 layout viewport 的底部和顶部，所以当 visual viewport 缩小的时候，保留在视觉中，。当你缩放页面时，布局视口不可能被全部看到，如果你放大布局视口的中间部分，内容将在四个方向上扩展，如果你有一个固定的头部和底部，它们依然固定在布局视口的头部和底部，因此它们可能会在设备屏幕的底部和顶部不可见——视觉视口。视觉视口是布局视口当前的可见部分，如果你向下滚动，视觉视口的内容就会改变，并且布局视口的底部就会滚动到可视区域。

视觉视口是屏幕的可视部分，不包括屏幕键盘，缩放外的区域。视觉视口比布局视口相同或者更小。

缩放会影响视觉视口的大小，当缩放程度是 100% 时，视觉视口与设备屏幕一样宽，放大使得视觉视口更小，因为屏幕上显示的 css 像素更小了。而缩小会使得视觉视口更大，因为屏幕上像素更多了。

## 布局视口

移动端设备的问题是，如果使视口的宽度和浏览器窗口宽度一样会导致很丑陋的结果。移动端浏览器通常宽度为 240 到 640 像素，且大多数设计给桌面的网站宽度至少为 800px，因此网站内容在手机上看起来非常窄。

在手机上，视口与浏览器屏幕宽度不再关联，而是完全独立的，称为**布局视口**——CSS 布局会根据它来计算。并被它约束

为了容纳桌面浏览器设计的网站，移动设备默认布局视口宽度远大于屏幕宽度，设置为 980px 或者 1024px(由设备自己决定，也可能是其他值)，但是带来的后果就是横向滚动条。因为浏览器的可视区域是比这个默认的 viewport 要小的。

当用户缩放时，只有视觉视口的尺寸会改变，布局视口不会改变。移动端的缩放不会导致 css 布局被重新计算。

## 理想视口

默认情况下，一个手机或者平板浏览器布局宽度是 980 或 1024 像素，虽然这能让桌面网站不被压扁，但是并不理想，尤其对于手机用户，因为在狭窄的屏幕上更适合一个狭窄的网站。

换句话说，布局视口的默认宽度并不是一个理想的宽度。这就是为什么苹果和其他仿效苹果的浏览器厂商，会引进理想视口。**它是对于设备来说，最理想的布局视口尺寸**，显示在理想视口中的网站拥有最理想的浏览和阅读宽度，用户刚进入页面时也不需要缩放。

**只有当网站是为手机准备的时候才应该使用理想视口**，只有主动向页面中添加`meta`视口标签时理想视口才会生效。如果没有`meta`视口标签声明，那么布局视口会维持它的默认宽度，理想视口只有在显式使用它时才会产生影响。

`<meta name="device" content="width=device-width">`

定义理想视口是浏览器的工作，而不是设备或者操作系统的工作。因此同一个设备上不同的浏览器拥有不同的理想视口，。`screen.widht/height`返回的是理想视口尺寸。

【注意】当设备方向改变的时候，iphone 中的理想视口`screen.width/height`并不会改变，但是安卓设备会改变。而布局视口`document.documentElement.clientWidth`和视觉视口的值，苹果和安卓都会改变。