# 在服务器上搭建 Git

## 几种协议

## 搭建

在开始架设 Git 服务器前，需要将现有的仓库导出为**裸仓库**——不包含当前工作目录的仓库。这通常是很简单的，为了通过克隆你的仓库来创建宇哥新的仓库，需要在克隆命令后加上`-bare`选项即可。按照惯例，裸仓库目录名以`.git`结尾。

只取出 Git 仓库自身，不要工作目录。

### 将裸仓库放到服务器上

已经有了裸仓库副本，剩下的就是将裸仓库放到服务器上并设置协议。假设一个域名为`git.example.com1`服务器已经架设好，并且可以通过 ssh 连接，你想要将所有 Git 仓库放在`/opt/git`下，架设服务器上存在`/opt/git`目录，你可以通过`scp -r my_project.git user@git.example.com:/opt/git`来复制裸仓库创建一个新仓库。此时，其他通过 SSH 连接这台服务器并对于`/opt/git`目录拥有可读权限的使用者，通过运行`git clone user@git.example.com:/opt/git/my_project.git`就可以克隆你的仓库。

如果一个用户，通过使用`SSH`连接到一个服务器，并且对`/opt/git/my_project.git`拥有可写权限，那么他将自动拥有推送权利。

如果到该项目目录中运行`git init --shared`选项，那么 git 会自动修改该仓库目录组权限为可写。

以上根据现有 Git 仓库创建一个裸仓库，然后将它放上和协作者都有 ssh 访问权的服务器，就可以在同一个项目上开展合作了。