# 认识

## 什么是微服务

微服务之前绝大部分基于 web 的应用都是使用单体架构的风格来进行构建的。单体架构中应用程序作为单个可部署的软件制品交付，所有的业务、UI、数据库访问逻辑都被打包在一个应用程序中，并且部署在一个应用服务器上。随着单体应用规模的扩大，在这个应用程序上进行开发的各个团队的沟通与合作的成本没有减少。每当各个团队需要修改代码时，整个应用程序都需要重新构建、测试和部署。

微服务的概念是对在技术上和组织上扩大大型单体应用程序所面临的诸多挑战的直接回应。微服务是一个小的、松耦合的分布式服务。微服务允许将一个大型的应用分解为具有严格职责定义的便于管理的组件。微服务通过将大型代码分解为小型的精确定义的部分，帮助解决大型代码库中传统的复杂问题。在思考微服务时，一个需要信奉的重要概念是，分解和分离应用程序的功能，使它们完全彼此独立。


微服务架构具有以下特征：
- 应用程序逻辑分解为具有明确定义了职责范围的细粒度组件，这些组件互相协调提供解决方案
- 每个组件有一个小的职责领域并且完全独立部署。微服务应该对业务领域的单个部分负责，此外，一个微服务应该可以跨多个应用程序复用
- 微服务通信基于一些基本的原则，并采用 HTTP 和 JSON 这样的轻量级通信协议，在服务消费者和服务提供者之间进行数据交换
- 服务的底层采用什么技术实现并没有什么影响，因为应用程序始终使用技术中立的协议(JSON是最常见的)进行通信。这意味着构建在为服务之上的应用程序能够使用多种编程语言和技术进行构建
- 微服务利用其小、独立和分布式的性质，使得组织拥有明确责任领域的小型开发团队。这些团队可能为同一个目标工作，如交付一个应用程序，但是每个团队只负责他们正在做的服务

## 为什么要改变构建应用的方式

现代社会的几乎所有方面都可以通过互联网连接在一起，习惯于为当地市场服务的公司突然发现，他们可以接触到全球的客户群，全球更大的客户群一起涌进来的同时也带来了全球竞争。这些竞争压力意味着下面的方面影响开发人员考虑构建应用程序的方式：
- **复杂性上升**——客户期望组织的所有部门都知道他们是谁。与单个数据库通信并且不与其他应用程序集成的”孤立的“应用程序已经不再是常态。如今，应用程序不仅需要与多个位于公司数据中心内的服务和数据库进行通信，还需要通过互联网与外部服务提供商提供的服务和数据库进行通信
- **更快速的交付**——客户不再希望等待软件包的下一次年度发布或整体版本更新，更期望软件产品中的功能被拆分，以便在几周甚至几天之内即可快速发布新功能
- **性能和可伸缩性**——全球性的应用程序使得预测应用程序将处理多少事务量以及何时触发该事务量变得非常困难，应用程序需要快速跨多个服务器进行扩大，然后在事务量高峰过去时的进行收缩
- **客户期望他们的应用程序可用**——因为客户和竞争对手之间只有点击一下鼠标的距离，所以企业的应用程序必须具有高度的弹性，应用程序中某个部分的故障或问题不应该导致整个应用程序崩溃。

为了满足这些期望，作为开发人员不得不接受这样一个悖论：构建一个高可伸缩性和高度冗余的程序。我们需要将应用程序分解为可以互相独立构建和部署的小型服务。如果将应用程序分解为小型服务，并将它们从单体制品中分离出来，就可以构建具有下面这些特性的系统：

- **灵活性**:可以将解耦的服务进行组合和重新编排，以快速交付新的功能。一个正在使用的代码单元越小，更改代码越不复杂。测试部署代码所需要的时间越短
- **有弹性**:解耦的服务意味着，故障可以限制在应用程序的一小部分之中，并在整个应用程序遇到中断之前被控制，这也使得应用程序在出现不可恢复的错误的情况下能够进行降级
- **可伸缩性**:解耦的服务可以轻松地跨多个服务器进行水平分布，从而可以适当地对功能/服务进行伸缩。单体应用程序中的所有逻辑是交织在一起的，即使只有一小部分应用程序是瓶颈，整个程序也需要扩展。小型服务的扩展是局部的，成本效益更高

## 云到底是什么

云计算有三种基本模式：
- 基础设施即服务(Infrastructure as a service)，IaaS
- 平台即服务(Platfomr as a Service) PaaS
- 软件即服务(Software as a Service) SaaS

新的云平台：函数即服务(FaaS)和容器即服务(CaaS)。

## 为什么是云和微服务

微服务架构的核心概念之一是每个服务都被打包和部署为离散的独立制品。服务实例应该迅速启动，服务的每一个实例都是完全相同的。

作为编写微服务的开发人员，迟早都要决定是否将服务部署到某个环境中：
- **物理服务器**
- **虚拟机镜像**
- **虚拟容器**